## Домашнее задание к занятию "5.5. Оркестрация кластером Docker контейнеров на примере Docker Swarm"
---


### Задача 1

Дайте письменные ответы на следующие вопросы:

---
#### 1) В чём отличие режимов работы сервисов в Docker Swarm кластере: replication и global?

#### Ответ:
----
1) Режим работы сервисов replication  предполагает что, количество запущенных экземпляров данного сервиса
    не превысит числа, заданного в файле конфигурации SWARM-кластера.
2) Режим работы сервисов global предполагает, что на каждой запускаемой ноде кластера будет обязательно развернут один экземпляр данного сервиса.
   Пример такого сервиса - агент мониторинга nodeexporter. 

---
####  2) Какой алгоритм выбора лидера используется в Docker Swarm кластере?

#### Ответ:
----
 При создании кластера  команда  ("docker swarm init" )  роль  leader выдается  самой первой созданной ноде, которая стартует в режиме manager.
 При инциденте выбывания из строя ноды с ролью leader, данная  роль  назначается одной из других  активных нод,  работающих в режиме manager
 на основании механизма RAFT.

---
####  3) Что такое Overlay Network?

#### Ответ:
----
Сетевой overlay-драйвер создает распределенную шифрованную сеть между несколькими контейнерами, создаваемыми демоном Docker. 
Overlay-сеть использует технологию vxlan, которая инкапсулирует layer 2 фреймы в layer 4 пакеты (UDP/IP).
Эта  сеть находится поверх сети, основанной на  работе по протоколу TCP/IP, позволяя общаться контейнерам, 
подключенным к ней (включая контейнеры служб SWARM-кластера). 

Любые точки, которые являются частью этой виртуальной сети, выглядят друг для друга так, 
будто они связаны  через коммутатор и не заботятся об устройстве основной физической сети.
Docker прозрачно обрабатывает маршрутизацию каждого пакета от и к соответствующему хосту демона Docker 
и соответствующему контейнеру назначения.

Инициализируете SWARM кластер или  к нем  присоединяете хост Docker, на этом хосте Docker создаются две новые сети
(смотрим через docker network ls):
1) оверлейная сеть под названием ingress, которая обрабатывает трафик управления и данных, связанный со службами кластера.
   Сеть ingress нужна только для того, чтобы устанавливать входящие соединения с контейнерами из внешнего мира.
   Также именно в ней происходит балансировка нагрузки, которую предоставляет swarm-кластер.
   Когда создается swarm-сервис и явно не подключается к определяемой пользователем оверлейной сети, он подключается к ingress сети по умолчанию.
   

2) Docker создает bridge-интерфейс для каждой overlay-сети, который соединяет виртуальные туннельные интерфейсы, 
    выполняющие vxlan туннельную связь между хостами.
    Таким образом, сеть docker_bridge соединяет каждую ноду кластера SWARM с другими нодами, участвующими в кластере SWARM.
    Создается на КАЖДОЙ ноде swarm-кластера. 

---
### Задача 2
---
Создать ваш первый Docker Swarm кластер в Яндекс.Облаке
Для получения зачета, вам необходимо предоставить скриншот из терминала (консоли), с выводом команды:
docker node ls


### Ответ:
----


---
###  Задача 3
---
Создать ваш первый, готовый к боевой эксплуатации кластер мониторинга, состоящий из стека микросервисов.
Для получения зачета, вам необходимо предоставить скриншот из терминала (консоли), с выводом команды:
docker service ls


### Ответ:
----


Задача 4 (*)
Выполнить на лидере Docker Swarm кластера команду (указанную ниже) и дать письменное описание её функционала, что она делает и зачем она нужна:

# см.документацию: https://docs.docker.com/engine/swarm/swarm_manager_locking/
docker swarm update --autolock=true